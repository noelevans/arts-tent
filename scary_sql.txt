User.objects.exclude(userprofile__itinerary__booking__start__lte=today).exclude(userprofile__itinerary__booking__end__gte=today)

User.objects.filter(userprofile__role__name=role).filter(userprofile__city=where).exclude(userprofile__itinerary__booking__start__lte=today).exclude(userprofile__itinerary__booking__end__gte=today)

SELECT "auth_user"."id", "auth_user"."username", "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_user"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user" WHERE (NOT ("auth_user"."id" IN (SELECT U1."user_id" FROM "auth_user" U0 INNER JOIN "users_userprofile" U1 ON (U0."id" = U1."user_id") INNER JOIN "itinerary_itinerary" U2 ON (U1."itinerary_id" = U2."id") INNER JOIN "itinerary_booking" U3 ON (U2."id" = U3."itinerary_id") WHERE U3."start" <= 2009-05-15 )) AND NOT ("auth_user"."id" IN (SELECT U1."user_id" FROM "auth_user" U0 INNER JOIN "users_userprofile" U1 ON (U0."id" = U1."user_id") INNER JOIN "itinerary_itinerary" U2 ON (U1."itinerary_id" = U2."id") INNER JOIN "itinerary_booking" U3 ON (U2."id" = U3."itinerary_id") WHERE U3."end" >= 2009-05-15 ))) LIMIT 21


'SELECT "auth_user"."id", "auth_user"."username", "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_user"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user" INNER JOIN "users_userprofile" ON ("auth_user"."id" = "users_userprofile"."user_id") INNER JOIN "users_userprofile_role" ON ("users_userprofile"."id" = "users_userprofile_role"."userprofile_id") INNER JOIN "users_userprofile" T6 ON ("auth_user"."id" = T6."user_id") WHERE ("users_userprofile_role"."roletag_id" = Ballerina  AND T6."city" = LondonN  AND NOT ("auth_user"."id" IN (SELECT U1."user_id" FROM "auth_user" U0 INNER JOIN "users_userprofile" U1 ON (U0."id" = U1."user_id") INNER JOIN "itinerary_itinerary" U2 ON (U1."itinerary_id" = U2."id") INNER JOIN "itinerary_booking" U3 ON (U2."id" = U3."itinerary_id") WHERE U3."start" <= 2009-05-15 )) AND NOT ("auth_user"."id" IN (SELECT U1."user_id" FROM "auth_user" U0 INNER JOIN "users_userprofile" U1 ON (U0."id" = U1."user_id") INNER JOIN "itinerary_itinerary" U2 ON (U1."itinerary_id" = U2."id") INNER JOIN "itinerary_booking" U3 ON (U2."id" = U3."itinerary_id") WHERE U3."end" >= 2009-05-15 ))) LIMIT 21
